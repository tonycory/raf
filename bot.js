var ot=Object.defineProperty;var at=(n,e,t)=>e in n?ot(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var p=(n,e,t)=>(at(n,typeof e!="symbol"?e+"":e,t),t);import{a as ct}from"./assets/_commonjsHelpers-de833af9.js";const be=new Map;function ut(n){const e=Array.isArray(n)?n:[n],t=e.join(","),r=be.get(t)??(()=>{const s=Ue(e),i=ht(s);return be.set(t,i),i})();return s=>r(s)}function Ue(n){return Array.isArray(n)?n.map(e=>e.split(":")):[n.split(":")]}function ht(n){const e=n.flatMap(s=>lt(s,Oe(s))),t=pt(e),r=mt(t);return s=>!!r(s.update,s)}function Oe(n){const e=Z,t=[n].flatMap(r=>{const[s,i,o]=r;if(!(s in Te))return[r];if(!s&&!i&&!o)return[r];const c=Te[s].map(l=>[l,i,o]);return i===void 0||i in ie&&(i||o)?c:c.filter(([l])=>{var h;return!!((h=e[l])!=null&&h[i])})}).flatMap(r=>{const[s,i,o]=r;if(!(i in ie))return[r];if(!i&&!o)return[r];const c=ie[i].map(l=>[s,l,o]);return o===void 0?c:c.filter(([,l])=>{var h,d;return!!((d=(h=e[s])==null?void 0:h[l])!=null&&d[o])})});if(t.length===0)throw new Error(`Shortcuts in '${n.join(":")}' do not expand to any valid filter query`);return t}function lt(n,e){if(e.length===0)throw new Error("Empty filter query given");const t=e.map(dt).filter(r=>r!==!0);if(t.length===0)return e;throw t.length===1?new Error(t[0]):new Error(`Invalid filter query '${n.join(":")}'. There are ${t.length} errors after expanding the contained shortcuts: ${t.join("; ")}`)}function dt(n){const[e,t,r,...s]=n;if(e===void 0)return"Empty filter query given";if(!(e in Z)){const u=Object.keys(Z);return`Invalid L1 filter '${e}' given in '${n.join(":")}'. Permitted values are: ${u.map(c=>`'${c}'`).join(", ")}.`}if(t===void 0)return!0;const i=Z[e];if(!(t in i)){const u=Object.keys(i);return`Invalid L2 filter '${t}' given in '${n.join(":")}'. Permitted values are: ${u.map(c=>`'${c}'`).join(", ")}.`}if(r===void 0)return!0;const o=i[t];if(!(r in o)){const u=Object.keys(o);return`Invalid L3 filter '${r}' given in '${n.join(":")}'. ${u.length===0?`No further filtering is possible after '${e}:${t}'.`:`Permitted values are: ${u.map(c=>`'${c}'`).join(", ")}.`}`}return s.length===0?!0:`Cannot filter further than three levels, ':${s.join(":")}' is invalid!`}function pt(n){const e={};for(const[t,r,s]of n){const i=e[t]??(e[t]={});if(r!==void 0){const o=i[r]??(i[r]=new Set);s!==void 0&&o.add(s)}}return e}function se(n,e){return(t,r)=>n(t,r)||e(t,r)}function _e(n,e){return(t,r)=>{const s=n(t,r);return s&&e(s,r)}}function ve(n){return(e,t)=>n(e,t)!=null}function mt(n){const e=Object.entries(n).map(([t,r])=>{const s=o=>o[t],i=Object.entries(r).map(([o,u])=>{const c=h=>h[o],l=Array.from(u).map(h=>h==="me"?(m,_)=>{const f=_.me.id;return Me(m,g=>g.id===f)}:m=>Me(m,_=>_[h]||_.type===h));return l.length===0?ve(c):_e(c,l.reduce(se))});return i.length===0?ve(s):_e(s,i.reduce(se))});if(e.length===0)throw new Error("Cannot create filter function for empty query");return e.reduce(se)}function Me(n,e){const t=r=>r!=null&&e(r);return Array.isArray(n)?n.some(t):t(n)}const Ie={mention:{},hashtag:{},cashtag:{},bot_command:{},url:{},email:{},phone_number:{},bold:{},italic:{},underline:{},strikethrough:{},spoiler:{},blockquote:{},expandable_blockquote:{},code:{},pre:{},text_link:{},text_mention:{},custom_emoji:{}},ae={me:{},is_bot:{},is_premium:{},added_to_attachment_menu:{}},ft={user:{},hidden_user:{},chat:{},channel:{}},gt={is_video:{},is_animated:{},premium_animation:{}},ce={emoji:{},custom_emoji:{},paid:{}},Qe={forward_origin:ft,is_topic_message:{},is_automatic_forward:{},business_connection_id:{},text:{},animation:{},audio:{},document:{},paid_media:{},photo:{},sticker:gt,story:{},video:{},video_note:{},voice:{},contact:{},dice:{},game:{},poll:{},venue:{},location:{},entities:Ie,caption_entities:Ie,caption:{},effect_id:{},has_media_spoiler:{},new_chat_title:{},new_chat_photo:{},delete_chat_photo:{},message_auto_delete_timer_changed:{},pinned_message:{},invoice:{},proximity_alert_triggered:{},chat_background_set:{},giveaway_created:{},giveaway:{only_new_members:{},has_public_winners:{}},giveaway_winners:{only_new_members:{},was_refunded:{}},giveaway_completed:{},video_chat_scheduled:{},video_chat_started:{},video_chat_ended:{},video_chat_participants_invited:{},web_app_data:{}},J={...Qe,new_chat_members:ae,left_chat_member:ae,group_chat_created:{},supergroup_chat_created:{},migrate_to_chat_id:{},migrate_from_chat_id:{},successful_payment:{},refunded_payment:{},users_shared:{},chat_shared:{},connected_website:{},write_access_allowed:{},passport_data:{},boost_added:{},forum_topic_created:{},forum_topic_edited:{name:{},icon_custom_emoji_id:{}},forum_topic_closed:{},forum_topic_reopened:{},general_forum_topic_hidden:{},general_forum_topic_unhidden:{},sender_boost_count:{}},ke={...Qe,channel_chat_created:{}},yt={can_reply:{},is_enabled:{}},wt={old_reaction:ce,new_reaction:ce},Ct={reactions:ce},bt={data:{},game_short_name:{}},Se={from:ae},Z={message:J,edited_message:J,channel_post:ke,edited_channel_post:ke,business_connection:yt,business_message:J,edited_business_message:J,deleted_business_messages:{},inline_query:{},chosen_inline_result:{},callback_query:bt,shipping_query:{},pre_checkout_query:{},poll:{},poll_answer:{},my_chat_member:Se,chat_member:Se,chat_join_request:{},message_reaction:wt,message_reaction_count:Ct,chat_boost:{},removed_chat_boost:{},purchased_paid_media:{}},Te={"":["message","channel_post"],msg:["message","channel_post"],edit:["edited_message","edited_channel_post"]},ie={"":["entities","caption_entities"],media:["photo","video"],file:["photo","animation","audio","document","video","video_note","voice","sticker"]},k={filterQuery(n){const e=ut(n);return t=>e(t)},text(n){const e=k.filterQuery([":text",":caption"]),t=F(n);return r=>{if(!e(r))return!1;const s=r.message??r.channelPost,i=s.text??s.caption;return R(r,i,t)}},command(n){const e=k.filterQuery(":entities:bot_command"),t=new Set,r=new Set;return ee(n).forEach(s=>{if(s.startsWith("/"))throw new Error(`Do not include '/' when registering command handlers (use '${s.substring(1)}' not '${s}')`);(s.includes("@")?t:r).add(s)}),s=>{if(!e(s))return!1;const i=s.message??s.channelPost,o=i.text??i.caption;return i.entities.some(u=>{if(u.type!=="bot_command"||u.offset!==0)return!1;const c=o.substring(1,u.length);if(r.has(c)||t.has(c))return s.match=o.substring(c.length+1).trimStart(),!0;const l=c.indexOf("@");if(l===-1)return!1;const h=c.substring(l+1).toLowerCase(),d=s.me.username.toLowerCase();if(h!==d)return!1;const m=c.substring(0,l);return r.has(m)?(s.match=o.substring(c.length+1).trimStart(),!0):!1})}},reaction(n){const e=k.filterQuery("message_reaction"),t=typeof n=="string"?[{type:"emoji",emoji:n}]:(Array.isArray(n)?n:[n]).map(o=>typeof o=="string"?{type:"emoji",emoji:o}:o),r=new Set(t.filter(o=>o.type==="emoji").map(o=>o.emoji)),s=new Set(t.filter(o=>o.type==="custom_emoji").map(o=>o.custom_emoji_id)),i=t.some(o=>o.type==="paid");return o=>{if(!e(o))return!1;const{old_reaction:u,new_reaction:c}=o.messageReaction;for(const l of c){let h=!1;if(l.type==="emoji"){for(const d of u)if(d.type==="emoji"&&d.emoji===l.emoji){h=!0;break}}else if(l.type==="custom_emoji"){for(const d of u)if(d.type==="custom_emoji"&&d.custom_emoji_id===l.custom_emoji_id){h=!0;break}}else if(l.type==="paid"){for(const d of u)if(d.type==="paid"){h=!0;break}}if(!h)if(l.type==="emoji"){if(r.has(l.emoji))return!0}else if(l.type==="custom_emoji"){if(s.has(l.custom_emoji_id))return!0}else if(l.type==="paid"){if(i)return!0}else return!0}return!1}},chatType(n){const e=new Set(ee(n));return t=>{var r;return((r=t.chat)==null?void 0:r.type)!==void 0&&e.has(t.chat.type)}},callbackQuery(n){const e=k.filterQuery("callback_query:data"),t=F(n);return r=>e(r)&&R(r,r.callbackQuery.data,t)},gameQuery(n){const e=k.filterQuery("callback_query:game_short_name"),t=F(n);return r=>e(r)&&R(r,r.callbackQuery.game_short_name,t)},inlineQuery(n){const e=k.filterQuery("inline_query"),t=F(n);return r=>e(r)&&R(r,r.inlineQuery.query,t)},chosenInlineResult(n){const e=k.filterQuery("chosen_inline_result"),t=F(n);return r=>e(r)&&R(r,r.chosenInlineResult.result_id,t)},preCheckoutQuery(n){const e=k.filterQuery("pre_checkout_query"),t=F(n);return r=>e(r)&&R(r,r.preCheckoutQuery.invoice_payload,t)},shippingQuery(n){const e=k.filterQuery("shipping_query"),t=F(n);return r=>e(r)&&R(r,r.shippingQuery.invoice_payload,t)}},v=class v{constructor(e,t,r){p(this,"update");p(this,"api");p(this,"me");p(this,"match");this.update=e,this.api=t,this.me=r}get message(){return this.update.message}get editedMessage(){return this.update.edited_message}get channelPost(){return this.update.channel_post}get editedChannelPost(){return this.update.edited_channel_post}get businessConnection(){return this.update.business_connection}get businessMessage(){return this.update.business_message}get editedBusinessMessage(){return this.update.edited_business_message}get deletedBusinessMessages(){return this.update.deleted_business_messages}get messageReaction(){return this.update.message_reaction}get messageReactionCount(){return this.update.message_reaction_count}get inlineQuery(){return this.update.inline_query}get chosenInlineResult(){return this.update.chosen_inline_result}get callbackQuery(){return this.update.callback_query}get shippingQuery(){return this.update.shipping_query}get preCheckoutQuery(){return this.update.pre_checkout_query}get poll(){return this.update.poll}get pollAnswer(){return this.update.poll_answer}get myChatMember(){return this.update.my_chat_member}get chatMember(){return this.update.chat_member}get chatJoinRequest(){return this.update.chat_join_request}get chatBoost(){return this.update.chat_boost}get removedChatBoost(){return this.update.removed_chat_boost}get purchasedPaidMedia(){return this.update.purchased_paid_media}get msg(){var e;return this.message??this.editedMessage??this.channelPost??this.editedChannelPost??this.businessMessage??this.editedBusinessMessage??((e=this.callbackQuery)==null?void 0:e.message)}get chat(){var e;return(e=this.msg??this.deletedBusinessMessages??this.messageReaction??this.messageReactionCount??this.myChatMember??this.chatMember??this.chatJoinRequest??this.chatBoost??this.removedChatBoost)==null?void 0:e.chat}get senderChat(){var e;return(e=this.msg)==null?void 0:e.sender_chat}get from(){var e,t,r,s;return((r=this.businessConnection??this.messageReaction??((t=((e=this.chatBoost)==null?void 0:e.boost)??this.removedChatBoost)==null?void 0:t.source))==null?void 0:r.user)??((s=this.callbackQuery??this.msg??this.inlineQuery??this.chosenInlineResult??this.shippingQuery??this.preCheckoutQuery??this.myChatMember??this.chatMember??this.chatJoinRequest??this.purchasedPaidMedia)==null?void 0:s.from)}get msgId(){var e,t,r;return((e=this.msg)==null?void 0:e.message_id)??((t=this.messageReaction)==null?void 0:t.message_id)??((r=this.messageReactionCount)==null?void 0:r.message_id)}get chatId(){var e,t;return((e=this.chat)==null?void 0:e.id)??((t=this.businessConnection)==null?void 0:t.user_chat_id)}get inlineMessageId(){var e,t;return((e=this.callbackQuery)==null?void 0:e.inline_message_id)??((t=this.chosenInlineResult)==null?void 0:t.inline_message_id)}get businessConnectionId(){var e,t,r;return((e=this.msg)==null?void 0:e.business_connection_id)??((t=this.businessConnection)==null?void 0:t.id)??((r=this.deletedBusinessMessages)==null?void 0:r.business_connection_id)}entities(e){const t=this.msg;if(t===void 0)return[];const r=t.text??t.caption;if(r===void 0)return[];let s=t.entities??t.caption_entities;if(s===void 0)return[];if(e!==void 0){const i=new Set(ee(e));s=s.filter(o=>i.has(o.type))}return s.map(i=>({...i,text:r.substring(i.offset,i.offset+i.length)}))}reactions(){const e=[],t=[],r=[],s=[],i=[],o=[],u=[],c=[];let l=!1,h=!1;const d=this.messageReaction;if(d!==void 0){const{old_reaction:m,new_reaction:_}=d;for(const f of _)f.type==="emoji"?e.push(f.emoji):f.type==="custom_emoji"?i.push(f.custom_emoji_id):f.type==="paid"&&(l=h=!0);for(const f of m)f.type==="emoji"?s.push(f.emoji):f.type==="custom_emoji"?c.push(f.custom_emoji_id):f.type==="paid"&&(h=!1);t.push(...e),o.push(...i);for(let f=0;f<s.length;f++){const g=t.length;if(g===0)break;const y=s[f];for(let w=0;w<g;w++)if(y===t[w]){r.push(y),s.splice(f,1),t.splice(w,1),f--;break}}for(let f=0;f<c.length;f++){const g=o.length;if(g===0)break;const y=c[f];for(let w=0;w<g;w++)if(y===o[w]){u.push(y),c.splice(f,1),o.splice(w,1),f--;break}}}return{emoji:e,emojiAdded:t,emojiKept:r,emojiRemoved:s,customEmoji:i,customEmojiAdded:o,customEmojiKept:u,customEmojiRemoved:c,paid:l,paidAdded:h}}has(e){return v.has.filterQuery(e)(this)}hasText(e){return v.has.text(e)(this)}hasCommand(e){return v.has.command(e)(this)}hasReaction(e){return v.has.reaction(e)(this)}hasChatType(e){return v.has.chatType(e)(this)}hasCallbackQuery(e){return v.has.callbackQuery(e)(this)}hasGameQuery(e){return v.has.gameQuery(e)(this)}hasInlineQuery(e){return v.has.inlineQuery(e)(this)}hasChosenInlineResult(e){return v.has.chosenInlineResult(e)(this)}hasPreCheckoutQuery(e){return v.has.preCheckoutQuery(e)(this)}hasShippingQuery(e){return v.has.shippingQuery(e)(this)}reply(e,t,r){return this.api.sendMessage(a(this.chatId,"sendMessage"),e,{business_connection_id:this.businessConnectionId,...t},r)}forwardMessage(e,t,r){return this.api.forwardMessage(e,a(this.chatId,"forwardMessage"),a(this.msgId,"forwardMessage"),t,r)}forwardMessages(e,t,r,s){return this.api.forwardMessages(e,a(this.chatId,"forwardMessages"),t,r,s)}copyMessage(e,t,r){return this.api.copyMessage(e,a(this.chatId,"copyMessage"),a(this.msgId,"copyMessage"),t,r)}copyMessages(e,t,r,s){return this.api.copyMessages(e,a(this.chatId,"copyMessages"),t,r,s)}replyWithPhoto(e,t,r){return this.api.sendPhoto(a(this.chatId,"sendPhoto"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAudio(e,t,r){return this.api.sendAudio(a(this.chatId,"sendAudio"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithDocument(e,t,r){return this.api.sendDocument(a(this.chatId,"sendDocument"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideo(e,t,r){return this.api.sendVideo(a(this.chatId,"sendVideo"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAnimation(e,t,r){return this.api.sendAnimation(a(this.chatId,"sendAnimation"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVoice(e,t,r){return this.api.sendVoice(a(this.chatId,"sendVoice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideoNote(e,t,r){return this.api.sendVideoNote(a(this.chatId,"sendVideoNote"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithMediaGroup(e,t,r){return this.api.sendMediaGroup(a(this.chatId,"sendMediaGroup"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithLocation(e,t,r,s){return this.api.sendLocation(a(this.chatId,"sendLocation"),e,t,{business_connection_id:this.businessConnectionId,...r},s)}editMessageLiveLocation(e,t,r,s){const i=this.inlineMessageId;return i!==void 0?this.api.editMessageLiveLocationInline(i,e,t,r):this.api.editMessageLiveLocation(a(this.chatId,"editMessageLiveLocation"),a(this.msgId,"editMessageLiveLocation"),e,t,r,s)}stopMessageLiveLocation(e,t){const r=this.inlineMessageId;return r!==void 0?this.api.stopMessageLiveLocationInline(r,e):this.api.stopMessageLiveLocation(a(this.chatId,"stopMessageLiveLocation"),a(this.msgId,"stopMessageLiveLocation"),e,t)}sendPaidMedia(e,t,r,s){return this.api.sendPaidMedia(a(this.chatId,"sendPaidMedia"),e,t,r,s)}replyWithVenue(e,t,r,s,i,o){return this.api.sendVenue(a(this.chatId,"sendVenue"),e,t,r,s,{business_connection_id:this.businessConnectionId,...i},o)}replyWithContact(e,t,r,s){return this.api.sendContact(a(this.chatId,"sendContact"),e,t,{business_connection_id:this.businessConnectionId,...r},s)}replyWithPoll(e,t,r,s){return this.api.sendPoll(a(this.chatId,"sendPoll"),e,t,{business_connection_id:this.businessConnectionId,...r},s)}replyWithDice(e,t,r){return this.api.sendDice(a(this.chatId,"sendDice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithChatAction(e,t,r){return this.api.sendChatAction(a(this.chatId,"sendChatAction"),e,{business_connection_id:this.businessConnectionId,...t},r)}react(e,t,r){return this.api.setMessageReaction(a(this.chatId,"setMessageReaction"),a(this.msgId,"setMessageReaction"),typeof e=="string"?[{type:"emoji",emoji:e}]:(Array.isArray(e)?e:[e]).map(s=>typeof s=="string"?{type:"emoji",emoji:s}:s),t,r)}getUserProfilePhotos(e,t){return this.api.getUserProfilePhotos(a(this.from,"getUserProfilePhotos").id,e,t)}setUserEmojiStatus(e,t){return this.api.setUserEmojiStatus(a(this.from,"setUserEmojiStatus").id,e,t)}getUserChatBoosts(e,t){return this.api.getUserChatBoosts(e,a(this.from,"getUserChatBoosts").id,t)}getBusinessConnection(e){return this.api.getBusinessConnection(a(this.businessConnectionId,"getBusinessConnection"),e)}getFile(e){const t=a(this.msg,"getFile"),r=t.photo!==void 0?t.photo[t.photo.length-1]:t.animation??t.audio??t.document??t.video??t.video_note??t.voice??t.sticker;return this.api.getFile(a(r,"getFile").file_id,e)}kickAuthor(...e){return this.banAuthor(...e)}banAuthor(e,t){return this.api.banChatMember(a(this.chatId,"banAuthor"),a(this.from,"banAuthor").id,e,t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r){return this.api.banChatMember(a(this.chatId,"banChatMember"),e,t,r)}unbanChatMember(e,t,r){return this.api.unbanChatMember(a(this.chatId,"unbanChatMember"),e,t,r)}restrictAuthor(e,t,r){return this.api.restrictChatMember(a(this.chatId,"restrictAuthor"),a(this.from,"restrictAuthor").id,e,t,r)}restrictChatMember(e,t,r,s){return this.api.restrictChatMember(a(this.chatId,"restrictChatMember"),e,t,r,s)}promoteAuthor(e,t){return this.api.promoteChatMember(a(this.chatId,"promoteAuthor"),a(this.from,"promoteAuthor").id,e,t)}promoteChatMember(e,t,r){return this.api.promoteChatMember(a(this.chatId,"promoteChatMember"),e,t,r)}setChatAdministratorAuthorCustomTitle(e,t){return this.api.setChatAdministratorCustomTitle(a(this.chatId,"setChatAdministratorAuthorCustomTitle"),a(this.from,"setChatAdministratorAuthorCustomTitle").id,e,t)}setChatAdministratorCustomTitle(e,t,r){return this.api.setChatAdministratorCustomTitle(a(this.chatId,"setChatAdministratorCustomTitle"),e,t,r)}banChatSenderChat(e,t){return this.api.banChatSenderChat(a(this.chatId,"banChatSenderChat"),e,t)}unbanChatSenderChat(e,t){return this.api.unbanChatSenderChat(a(this.chatId,"unbanChatSenderChat"),e,t)}setChatPermissions(e,t,r){return this.api.setChatPermissions(a(this.chatId,"setChatPermissions"),e,t,r)}exportChatInviteLink(e){return this.api.exportChatInviteLink(a(this.chatId,"exportChatInviteLink"),e)}createChatInviteLink(e,t){return this.api.createChatInviteLink(a(this.chatId,"createChatInviteLink"),e,t)}editChatInviteLink(e,t,r){return this.api.editChatInviteLink(a(this.chatId,"editChatInviteLink"),e,t,r)}createChatSubscriptionInviteLink(e,t,r,s){return this.api.createChatSubscriptionInviteLink(a(this.chatId,"createChatSubscriptionInviteLink"),e,t,r,s)}editChatSubscriptionInviteLink(e,t,r){return this.api.editChatSubscriptionInviteLink(a(this.chatId,"editChatSubscriptionInviteLink"),e,t,r)}revokeChatInviteLink(e,t){return this.api.revokeChatInviteLink(a(this.chatId,"editChatInviteLink"),e,t)}approveChatJoinRequest(e,t){return this.api.approveChatJoinRequest(a(this.chatId,"approveChatJoinRequest"),e,t)}declineChatJoinRequest(e,t){return this.api.declineChatJoinRequest(a(this.chatId,"declineChatJoinRequest"),e,t)}setChatPhoto(e,t){return this.api.setChatPhoto(a(this.chatId,"setChatPhoto"),e,t)}deleteChatPhoto(e){return this.api.deleteChatPhoto(a(this.chatId,"deleteChatPhoto"),e)}setChatTitle(e,t){return this.api.setChatTitle(a(this.chatId,"setChatTitle"),e,t)}setChatDescription(e,t){return this.api.setChatDescription(a(this.chatId,"setChatDescription"),e,t)}pinChatMessage(e,t,r){return this.api.pinChatMessage(a(this.chatId,"pinChatMessage"),e,t,r)}unpinChatMessage(e,t){return this.api.unpinChatMessage(a(this.chatId,"unpinChatMessage"),e,t)}unpinAllChatMessages(e){return this.api.unpinAllChatMessages(a(this.chatId,"unpinAllChatMessages"),e)}leaveChat(e){return this.api.leaveChat(a(this.chatId,"leaveChat"),e)}getChat(e){return this.api.getChat(a(this.chatId,"getChat"),e)}getChatAdministrators(e){return this.api.getChatAdministrators(a(this.chatId,"getChatAdministrators"),e)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e){return this.api.getChatMemberCount(a(this.chatId,"getChatMemberCount"),e)}getAuthor(e){return this.api.getChatMember(a(this.chatId,"getAuthor"),a(this.from,"getAuthor").id,e)}getChatMember(e,t){return this.api.getChatMember(a(this.chatId,"getChatMember"),e,t)}setChatStickerSet(e,t){return this.api.setChatStickerSet(a(this.chatId,"setChatStickerSet"),e,t)}deleteChatStickerSet(e){return this.api.deleteChatStickerSet(a(this.chatId,"deleteChatStickerSet"),e)}createForumTopic(e,t,r){return this.api.createForumTopic(a(this.chatId,"createForumTopic"),e,t,r)}editForumTopic(e,t){const r=a(this.msg,"editForumTopic"),s=a(r.message_thread_id,"editForumTopic");return this.api.editForumTopic(r.chat.id,s,e,t)}closeForumTopic(e){const t=a(this.msg,"closeForumTopic"),r=a(t.message_thread_id,"closeForumTopic");return this.api.closeForumTopic(t.chat.id,r,e)}reopenForumTopic(e){const t=a(this.msg,"reopenForumTopic"),r=a(t.message_thread_id,"reopenForumTopic");return this.api.reopenForumTopic(t.chat.id,r,e)}deleteForumTopic(e){const t=a(this.msg,"deleteForumTopic"),r=a(t.message_thread_id,"deleteForumTopic");return this.api.deleteForumTopic(t.chat.id,r,e)}unpinAllForumTopicMessages(e){const t=a(this.msg,"unpinAllForumTopicMessages"),r=a(t.message_thread_id,"unpinAllForumTopicMessages");return this.api.unpinAllForumTopicMessages(t.chat.id,r,e)}editGeneralForumTopic(e,t){return this.api.editGeneralForumTopic(a(this.chatId,"editGeneralForumTopic"),e,t)}closeGeneralForumTopic(e){return this.api.closeGeneralForumTopic(a(this.chatId,"closeGeneralForumTopic"),e)}reopenGeneralForumTopic(e){return this.api.reopenGeneralForumTopic(a(this.chatId,"reopenGeneralForumTopic"),e)}hideGeneralForumTopic(e){return this.api.hideGeneralForumTopic(a(this.chatId,"hideGeneralForumTopic"),e)}unhideGeneralForumTopic(e){return this.api.unhideGeneralForumTopic(a(this.chatId,"unhideGeneralForumTopic"),e)}unpinAllGeneralForumTopicMessages(e){return this.api.unpinAllGeneralForumTopicMessages(a(this.chatId,"unpinAllGeneralForumTopicMessages"),e)}answerCallbackQuery(e,t){return this.api.answerCallbackQuery(a(this.callbackQuery,"answerCallbackQuery").id,typeof e=="string"?{text:e}:e,t)}setChatMenuButton(e,t){return this.api.setChatMenuButton(e,t)}getChatMenuButton(e,t){return this.api.getChatMenuButton(e,t)}setMyDefaultAdministratorRights(e,t){return this.api.setMyDefaultAdministratorRights(e,t)}getMyDefaultAdministratorRights(e,t){return this.api.getMyDefaultAdministratorRights(e,t)}editMessageText(e,t,r){var i,o,u;const s=this.inlineMessageId;return s!==void 0?this.api.editMessageTextInline(s,e,t):this.api.editMessageText(a(this.chatId,"editMessageText"),a(((i=this.msg)==null?void 0:i.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((u=this.messageReactionCount)==null?void 0:u.message_id),"editMessageText"),e,t,r)}editMessageCaption(e,t){var s,i,o;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageCaptionInline(r,e):this.api.editMessageCaption(a(this.chatId,"editMessageCaption"),a(((s=this.msg)==null?void 0:s.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageCaption"),e,t)}editMessageMedia(e,t,r){var i,o,u;const s=this.inlineMessageId;return s!==void 0?this.api.editMessageMediaInline(s,e,t):this.api.editMessageMedia(a(this.chatId,"editMessageMedia"),a(((i=this.msg)==null?void 0:i.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((u=this.messageReactionCount)==null?void 0:u.message_id),"editMessageMedia"),e,t,r)}editMessageReplyMarkup(e,t){var s,i,o;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageReplyMarkupInline(r,e):this.api.editMessageReplyMarkup(a(this.chatId,"editMessageReplyMarkup"),a(((s=this.msg)==null?void 0:s.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageReplyMarkup"),e,t)}stopPoll(e,t){var r,s,i;return this.api.stopPoll(a(this.chatId,"stopPoll"),a(((r=this.msg)==null?void 0:r.message_id)??((s=this.messageReaction)==null?void 0:s.message_id)??((i=this.messageReactionCount)==null?void 0:i.message_id),"stopPoll"),e,t)}deleteMessage(e){var t,r,s;return this.api.deleteMessage(a(this.chatId,"deleteMessage"),a(((t=this.msg)==null?void 0:t.message_id)??((r=this.messageReaction)==null?void 0:r.message_id)??((s=this.messageReactionCount)==null?void 0:s.message_id),"deleteMessage"),e)}deleteMessages(e,t){return this.api.deleteMessages(a(this.chatId,"deleteMessages"),e,t)}replyWithSticker(e,t,r){return this.api.sendSticker(a(this.chatId,"sendSticker"),e,{business_connection_id:this.businessConnectionId,...t},r)}getCustomEmojiStickers(e){var t;return this.api.getCustomEmojiStickers((((t=this.msg)==null?void 0:t.entities)??[]).filter(r=>r.type==="custom_emoji").map(r=>r.custom_emoji_id),e)}replyWithGift(e,t,r){return this.api.sendGift(a(this.from,"sendGift").id,e,t,r)}answerInlineQuery(e,t,r){return this.api.answerInlineQuery(a(this.inlineQuery,"answerInlineQuery").id,e,t,r)}savePreparedInlineMessage(e,t,r){return this.api.savePreparedInlineMessage(a(this.from,"savePreparedInlineMessage").id,e,t,r)}replyWithInvoice(e,t,r,s,i,o,u){return this.api.sendInvoice(a(this.chatId,"sendInvoice"),e,t,r,s,i,o,u)}answerShippingQuery(e,t,r){return this.api.answerShippingQuery(a(this.shippingQuery,"answerShippingQuery").id,e,t,r)}answerPreCheckoutQuery(e,t,r){return this.api.answerPreCheckoutQuery(a(this.preCheckoutQuery,"answerPreCheckoutQuery").id,e,typeof t=="string"?{error_message:t}:t,r)}refundStarPayment(e){var t;return this.api.refundStarPayment(a(this.from,"refundStarPayment").id,a((t=this.msg)==null?void 0:t.successful_payment,"refundStarPayment").telegram_payment_charge_id,e)}editUserStarSubscription(e,t,r){return this.api.editUserStarSubscription(a(this.from,"editUserStarSubscription").id,e,t,r)}verifyUser(e,t){return this.api.verifyUser(a(this.from,"verifyUser").id,e,t)}verifyChat(e,t){return this.api.verifyChat(a(this.chatId,"verifyChat"),e,t)}removeUserVerification(e){return this.api.removeUserVerification(a(this.from,"removeUserVerification").id,e)}removeChatVerification(e){return this.api.removeChatVerification(a(this.chatId,"removeChatVerification"),e)}setPassportDataErrors(e,t){return this.api.setPassportDataErrors(a(this.from,"setPassportDataErrors").id,e,t)}replyWithGame(e,t,r){return this.api.sendGame(a(this.chatId,"sendGame"),e,{business_connection_id:this.businessConnectionId,...t},r)}};p(v,"has",k);let M=v;function a(n,e){if(n===void 0)throw new Error(`Missing information for API call to ${e}`);return n}function F(n){return ee(n).map(e=>typeof e=="string"?t=>t===e?e:null:t=>t.match(e))}function R(n,e,t){for(const r of t){const s=r(e);if(s)return n.match=s,!0}return!1}function ee(n){return Array.isArray(n)?n:[n]}class ue extends Error{constructor(t,r){super(_t(t));p(this,"error");p(this,"ctx");this.error=t,this.ctx=r,this.name="BotError",t instanceof Error&&(this.stack=t.stack)}}function _t(n){let e;if(n instanceof Error)e=`${n.name} in middleware: ${n.message}`;else{const t=typeof n;switch(e=`Non-error value of type ${t} thrown in middleware`,t){case"bigint":case"boolean":case"number":case"symbol":e+=`: ${n}`;break;case"string":e+=`: ${String(n).substring(0,50)}`;break;default:e+="!";break}}return e}function K(n){return typeof n=="function"?n:(e,t)=>n.middleware()(e,t)}function Ee(n,e){return async(t,r)=>{let s=!1;await n(t,async()=>{if(s)throw new Error("`next` already called before!");s=!0,await e(t,r)})}}function oe(n,e){return e()}const vt=()=>Promise.resolve();async function Ge(n,e){await n(e,vt)}class P{constructor(...e){p(this,"handler");this.handler=e.length===0?oe:e.map(K).reduce(Ee)}middleware(){return this.handler}use(...e){const t=new P(...e);return this.handler=Ee(this.handler,K(t)),t}on(e,...t){return this.filter(M.has.filterQuery(e),...t)}hears(e,...t){return this.filter(M.has.text(e),...t)}command(e,...t){return this.filter(M.has.command(e),...t)}reaction(e,...t){return this.filter(M.has.reaction(e),...t)}chatType(e,...t){return this.filter(M.has.chatType(e),...t)}callbackQuery(e,...t){return this.filter(M.has.callbackQuery(e),...t)}gameQuery(e,...t){return this.filter(M.has.gameQuery(e),...t)}inlineQuery(e,...t){return this.filter(M.has.inlineQuery(e),...t)}chosenInlineResult(e,...t){return this.filter(M.has.chosenInlineResult(e),...t)}preCheckoutQuery(e,...t){return this.filter(M.has.preCheckoutQuery(e),...t)}shippingQuery(e,...t){return this.filter(M.has.shippingQuery(e),...t)}filter(e,...t){const r=new P(...t);return this.branch(e,r,oe),r}drop(e,...t){return this.filter(async r=>!await e(r),...t)}fork(...e){const t=new P(...e),r=K(t);return this.use((s,i)=>Promise.all([i(),Ge(r,s)])),t}lazy(e){return this.use(async(t,r)=>{const s=await e(t),i=Array.isArray(s)?s:[s];await K(new P(...i))(t,r)})}route(e,t,r=oe){return this.lazy(async s=>{const i=await e(s);return(i===void 0||!t[i]?r:t[i])??[]})}branch(e,t,r){return this.lazy(async s=>await e(s)?t:r)}errorBoundary(e,...t){const r=new P(...t),s=K(r);return this.use(async(i,o)=>{let u=!1;const c=()=>(u=!0,Promise.resolve());try{await s(i,c)}catch(l){u=!1,await e(new ue(l,i),c)}u&&await o()}),r}}var V=1e3,B=V*60,q=B*60,j=q*24,Mt=j*7,It=j*365.25,kt=function(n,e){e=e||{};var t=typeof n;if(t==="string"&&n.length>0)return St(n);if(t==="number"&&isFinite(n))return e.long?Et(n):Tt(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))};function St(n){if(n=String(n),!(n.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(n);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*It;case"weeks":case"week":case"w":return t*Mt;case"days":case"day":case"d":return t*j;case"hours":case"hour":case"hrs":case"hr":case"h":return t*q;case"minutes":case"minute":case"mins":case"min":case"m":return t*B;case"seconds":case"second":case"secs":case"sec":case"s":return t*V;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Tt(n){var e=Math.abs(n);return e>=j?Math.round(n/j)+"d":e>=q?Math.round(n/q)+"h":e>=B?Math.round(n/B)+"m":e>=V?Math.round(n/V)+"s":n+"ms"}function Et(n){var e=Math.abs(n);return e>=j?H(n,e,j,"day"):e>=q?H(n,e,q,"hour"):e>=B?H(n,e,B,"minute"):e>=V?H(n,e,V,"second"):n+" ms"}function H(n,e,t,r){var s=e>=t*1.5;return Math.round(n/t)+" "+r+(s?"s":"")}function xe(){throw new Error("setTimeout has not been defined")}function Ve(){throw new Error("clearTimeout has not been defined")}var T=xe,E=Ve,G;typeof window<"u"?G=window:typeof self<"u"?G=self:G={};typeof G.setTimeout=="function"&&(T=setTimeout);typeof G.clearTimeout=="function"&&(E=clearTimeout);function Be(n){if(T===setTimeout)return setTimeout(n,0);if((T===xe||!T)&&setTimeout)return T=setTimeout,setTimeout(n,0);try{return T(n,0)}catch{try{return T.call(null,n,0)}catch{return T.call(this,n,0)}}}function At(n){if(E===clearTimeout)return clearTimeout(n);if((E===Ve||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(n);try{return E(n)}catch{try{return E.call(null,n)}catch{return E.call(this,n)}}}var S=[],x=!1,L,X=-1;function Ft(){!x||!L||(x=!1,L.length?S=L.concat(S):X=-1,S.length&&qe())}function qe(){if(!x){var n=Be(Ft);x=!0;for(var e=S.length;e;){for(L=S,S=[];++X<e;)L&&L[X].run();X=-1,e=S.length}L=null,x=!1,At(n)}}function Rt(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];S.push(new We(n,e)),S.length===1&&!x&&Be(qe)}function We(n,e){this.fun=n,this.array=e}We.prototype.run=function(){this.fun.apply(null,this.array)};var Pt="browser",Lt="browser",jt=!0,Dt=[],$t="",Nt={},Ut={},Ot={};function D(){}var Qt=D,Gt=D,xt=D,Vt=D,Bt=D,qt=D,Wt=D;function Kt(n){throw new Error("process.binding is not supported")}function Yt(){return"/"}function Jt(n){throw new Error("process.chdir is not supported")}function Ht(){return 0}var O=G.performance||{},zt=O.now||O.mozNow||O.msNow||O.oNow||O.webkitNow||function(){return new Date().getTime()};function Zt(n){var e=zt.call(O)*.001,t=Math.floor(e),r=Math.floor(e%1*1e9);return n&&(t=t-n[0],r=r-n[1],r<0&&(t--,r+=1e9)),[t,r]}var Xt=new Date;function er(){var n=new Date,e=n-Xt;return e/1e3}var Ae={nextTick:Rt,title:Pt,browser:jt,env:{NODE_ENV:"production"},argv:Dt,version:$t,versions:Nt,on:Qt,addListener:Gt,once:xt,off:Vt,removeListener:Bt,removeAllListeners:qt,emit:Wt,binding:Kt,cwd:Yt,chdir:Jt,umask:Ht,hrtime:Zt,platform:Lt,release:Ut,config:Ot,uptime:er};function tr(n,e,t){return t={path:e,exports:{},require:function(r,s){return rr(r,s??t.path)}},n(t,t.exports),t.exports}function rr(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function nr(n){t.debug=t,t.default=t,t.coerce=c,t.disable=i,t.enable=s,t.enabled=o,t.humanize=kt,t.destroy=l,Object.keys(n).forEach(h=>{t[h]=n[h]}),t.names=[],t.skips=[],t.formatters={};function e(h){let d=0;for(let m=0;m<h.length;m++)d=(d<<5)-d+h.charCodeAt(m),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(h){let d,m=null,_,f;function g(...y){if(!g.enabled)return;const w=g,$=Number(new Date),ne=$-(d||$);w.diff=ne,w.prev=d,w.curr=$,d=$,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let N=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(W,U)=>{if(W==="%%")return"%";N++;const Ce=t.formatters[U];if(typeof Ce=="function"){const it=y[N];W=Ce.call(w,it),y.splice(N,1),N--}return W}),t.formatArgs.call(w,y),(w.log||t.log).apply(w,y)}return g.namespace=h,g.useColors=t.useColors(),g.color=t.selectColor(h),g.extend=r,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(_!==t.namespaces&&(_=t.namespaces,f=t.enabled(h)),f),set:y=>{m=y}}),typeof t.init=="function"&&t.init(g),g}function r(h,d){const m=t(this.namespace+(typeof d>"u"?":":d)+h);return m.log=this.log,m}function s(h){t.save(h),t.namespaces=h,t.names=[],t.skips=[];let d;const m=(typeof h=="string"?h:"").split(/[\s,]+/),_=m.length;for(d=0;d<_;d++)m[d]&&(h=m[d].replace(/\*/g,".*?"),h[0]==="-"?t.skips.push(new RegExp("^"+h.slice(1)+"$")):t.names.push(new RegExp("^"+h+"$")))}function i(){const h=[...t.names.map(u),...t.skips.map(u).map(d=>"-"+d)].join(",");return t.enable(""),h}function o(h){if(h[h.length-1]==="*")return!0;let d,m;for(d=0,m=t.skips.length;d<m;d++)if(t.skips[d].test(h))return!1;for(d=0,m=t.names.length;d<m;d++)if(t.names[d].test(h))return!0;return!1}function u(h){return h.toString().substring(2,h.toString().length-2).replace(/\.\*\?$/,"*")}function c(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var sr=nr,b=tr(function(n,e){e.formatArgs=r,e.save=s,e.load=i,e.useColors=t,e.storage=o(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;c.splice(1,0,l,"color: inherit");let h=0,d=0;c[0].replace(/%[a-zA-Z%]/g,m=>{m!=="%%"&&(h++,m==="%c"&&(d=h))}),c.splice(d,0,l)}e.log=console.debug||console.log||(()=>{});function s(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function i(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof Ae<"u"&&"env"in Ae&&(c={}.DEBUG),c}function o(){try{return localStorage}catch{}}n.exports=sr(e);const{formatters:u}=n.exports;u.j=function(c){try{return JSON.stringify(c)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}});b.colors;b.destroy;b.formatArgs;b.load;b.log;b.save;b.storage;b.useColors;const ir=n=>{const e=n[Symbol.asyncIterator]();return new ReadableStream({async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)}})},or=n=>({}),Fe=b("grammy:warn");class fe extends Error{constructor(t,r,s,i){super(`${t} (${r.error_code}: ${r.description})`);p(this,"method");p(this,"payload");p(this,"ok");p(this,"error_code");p(this,"description");p(this,"parameters");this.method=s,this.payload=i,this.ok=!1,this.name="GrammyError",this.error_code=r.error_code,this.description=r.description,this.parameters=r.parameters??{}}}function ar(n,e,t){switch(n.error_code){case 401:Fe("Error 401 means that your bot token is wrong, talk to https://t.me/BotFather to check it.");break;case 409:Fe("Error 409 means that you are running your bot several times on long polling. Consider revoking the bot token if you believe that no other instance is running.");break}return new fe(`Call to '${e}' failed!`,n,e,t)}class Ke extends Error{constructor(t,r){super(t);p(this,"error");this.error=r,this.name="HttpError"}}function cr(n){return typeof n=="object"&&n!==null&&"status"in n&&"statusText"in n}function ur(n,e){return t=>{let r=`Network request for '${n}' failed!`;throw cr(t)&&(r+=` (${t.status}: ${t.statusText})`),e&&t instanceof Error&&(r+=` ${t.message}`),new Ke(r,t)}}const hr=(()=>{var t,r,s;const{Deno:n}=globalThis;if(typeof((t=n==null?void 0:n.build)==null?void 0:t.os)=="string")return n.build.os;const{navigator:e}=globalThis;return(s=(r=e==null?void 0:e.appVersion)==null?void 0:r.includes)!=null&&s.call(r,"Win")?"windows":"linux"})(),lr=hr==="windows";function dr(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function Ye(n,e){if(e.length>=n.length)return n;const t=n.length-e.length;for(let r=e.length-1;r>=0;--r)if(n.charCodeAt(t+r)!==e.charCodeAt(r))return n;return n.slice(0,-e.length)}function Je(n,e,t=0){let r=!1,s=n.length;for(let i=n.length-1;i>=t;--i)if(e(n.charCodeAt(i))){if(r){t=i+1;break}}else r||(r=!0,s=i+1);return n.slice(t,s)}function He(n,e){if(dr(n),n.length===0)return n;if(typeof e!="string")throw new TypeError(`Suffix must be a string. Received ${JSON.stringify(e)}`)}function ze(n,e){if(n.length<=1)return n;let t=n.length;for(let r=n.length-1;r>0&&e(n.charCodeAt(r));r--)t=r;return n.slice(0,t)}function Re(n){return n===47}function pr(n,e=""){He(n,e);const t=Je(n,Re),r=ze(t,Re);return e?Ye(r,e):r}function Pe(n){return n===47||n===92}function mr(n){return n>=97&&n<=122||n>=65&&n<=90}function fr(n,e=""){He(n,e);let t=0;if(n.length>=2){const i=n.charCodeAt(0);mr(i)&&n.charCodeAt(1)===58&&(t=2)}const r=Je(n,Pe,t),s=ze(r,Pe);return e?Ye(s,e):s}function z(n,e=""){return lr?fr(n,e):pr(n,e)}class he{constructor(e,t){p(this,"consumed",!1);p(this,"fileData");p(this,"filename");this.fileData=e,t??(t=this.guessFilename(e)),this.filename=t}guessFilename(e){if(typeof e=="string")return z(e);if(typeof e=="object"){if("url"in e)return z(e.url);if(e instanceof URL)return z(e.pathname)||z(e.hostname)}}toRaw(){if(this.consumed)throw new Error("Cannot reuse InputFile data source!");const e=this.fileData;return e instanceof Blob?e.stream():e instanceof URL?Le(e):"url"in e?Le(e.url):(e instanceof Uint8Array||(this.consumed=!0),e)}}async function*Le(n){const{body:e}=await fetch(n);if(e===null)throw new Error(`Download failed, no response body from '${n}'`);yield*e}function le(n){return n instanceof he||typeof n=="object"&&n!==null&&Object.values(n).some(e=>Array.isArray(e)?e.some(le):e instanceof he||le(e))}function Ze(n){return JSON.stringify(n,(e,t)=>t??void 0)}function je(n){return{method:"POST",headers:{"content-type":"application/json",connection:"keep-alive"},body:Ze(n)}}async function*gr(n,e){try{yield*n}catch(t){e(t)}}function yr(n,e){const t=wr(),r=Cr(n,t),s=gr(r,e),i=ir(s);return{method:"POST",headers:{"content-type":`multipart/form-data; boundary=${t}`,connection:"keep-alive"},body:i}}function wr(){return"----------"+Xe(32)}function Xe(n=16){return Array.from(Array(n)).map(()=>Math.random().toString(36)[2]||0).join("")}const Y=new TextEncoder;async function*Cr(n,e){const t=de(n);yield Y.encode(`--${e}\r
`);const r=Y.encode(`\r
--${e}\r
`);let s=!0;for(const[i,o]of Object.entries(n))o!=null&&(s||(yield r),yield br(i,typeof o=="object"?Ze(o):o),s=!1);for(const{id:i,origin:o,file:u}of t)s||(yield r),yield*_r(i,o,u),s=!1;yield Y.encode(`\r
--${e}--\r
`)}function de(n){return typeof n!="object"||n===null?[]:Object.entries(n).flatMap(([e,t])=>{if(Array.isArray(t))return t.flatMap(r=>de(r));if(t instanceof he){const r=Xe();Object.assign(n,{[e]:`attach://${r}`});const s=e==="media"&&"type"in n&&typeof n.type=="string"?n.type:e;return{id:r,origin:s,file:t}}else return de(t)})}function br(n,e){return Y.encode(`content-disposition:form-data;name="${n}"\r
\r
${e}`)}async function*_r(n,e,t){const r=t.filename||`${e}.${vr(e)}`;if(r.includes("\r")||r.includes(`
`))throw new Error(`File paths cannot contain carriage-return (\\r) or newline (\\n) characters! Filename for property '${e}' was:
"""
${r}
"""`);yield Y.encode(`content-disposition:form-data;name="${n}";filename=${r}\r
content-type:application/octet-stream\r
\r
`);const s=await t.toRaw();s instanceof Uint8Array?yield s:yield*s}function vr(n){switch(n){case"certificate":return"pem";case"photo":case"thumbnail":return"jpg";case"voice":return"ogg";case"audio":return"mp3";case"animation":case"video":case"video_note":return"mp4";case"sticker":return"webp";default:return"dat"}}const Mr=b("grammy:core");function Ir(n,e){return(t,r,s)=>e(n,t,r,s)}class kr{constructor(e,t={},r={}){p(this,"token");p(this,"webhookReplyEnvelope");p(this,"options");p(this,"fetch");p(this,"hasUsedWebhookReply");p(this,"installedTransformers");p(this,"call");this.token=e,this.webhookReplyEnvelope=r,this.hasUsedWebhookReply=!1,this.installedTransformers=[],this.call=async(c,l,h)=>{const d=l??{};Mr(`Calling ${c}`),h!==void 0&&Pr(c,d,h);const m=this.options,_=le(d);if(this.webhookReplyEnvelope.send!==void 0&&!this.hasUsedWebhookReply&&!_&&m.canUseWebhookReply(c)){this.hasUsedWebhookReply=!0;const U=je({...d,method:c});return await this.webhookReplyEnvelope.send(U.body),{ok:!0,result:!0}}const f=Rr(h),g=Ar(f,m.timeoutSeconds,c),y=Fr(f),w=m.buildUrl(m.apiRoot,this.token,c,m.environment),$=_?yr(d,U=>y.catch(U)):je(d),ne=f.signal,N={...m.baseFetchConfig,signal:ne,...$},W=[this.fetch(w instanceof URL?w.href:w,N).catch(ur(c,m.sensitiveLogs)),y.promise,g.promise];try{return await(await Promise.race(W)).json()}finally{g.handle!==void 0&&clearTimeout(g.handle)}};const s=t.apiRoot??"https://api.telegram.org",i=t.environment??"prod",{fetch:o}=t,u=o??fetch;if(this.options={apiRoot:s,environment:i,buildUrl:t.buildUrl??Tr,timeoutSeconds:t.timeoutSeconds??500,baseFetchConfig:{...or(),...t.baseFetchConfig},canUseWebhookReply:t.canUseWebhookReply??(()=>!1),sensitiveLogs:t.sensitiveLogs??!1,fetch:(...c)=>u(...c)},this.fetch=this.options.fetch,this.options.apiRoot.endsWith("/"))throw new Error(`Remove the trailing '/' from the 'apiRoot' option (use '${this.options.apiRoot.substring(0,this.options.apiRoot.length-1)}' instead of '${this.options.apiRoot}')`)}use(...e){return this.call=e.reduce(Ir,this.call),this.installedTransformers.push(...e),this}async callApi(e,t,r){const s=await this.call(e,t,r);if(s.ok)return s.result;throw ar(s,e,t)}}function Sr(n,e,t){const r=new kr(n,e,t),s={get(c,l){return l==="toJSON"?"__internal":l==="getMe"||l==="getWebhookInfo"||l==="getForumTopicIconStickers"||l==="getAvailableGifts"||l==="logOut"||l==="close"?r.callApi.bind(r,l,{}):r.callApi.bind(r,l)},...Er},i=new Proxy({},s),o=r.installedTransformers,u={raw:i,installedTransformers:o,use:(...c)=>(r.use(...c),u)};return u}const Tr=(n,e,t,r)=>`${n}/bot${e}/${r==="test"?"test/":""}${t}`,Er={set(){return!1},defineProperty(){return!1},deleteProperty(){return!1},ownKeys(){return[]}};function Ar(n,e,t){let r;return{promise:new Promise((i,o)=>{r=setTimeout(()=>{const u=`Request to '${t}' timed out after ${e} seconds`;o(new Error(u)),n.abort()},1e3*e)}),handle:r}}function Fr(n){let e=r=>{throw r};return{promise:new Promise((r,s)=>{e=i=>{s(i),n.abort()}}),catch:e}}function Rr(n){const e=new AbortController;if(n===void 0)return e;const t=n;function r(){e.abort(),t.removeEventListener("abort",r)}return t.aborted?r():t.addEventListener("abort",r),{abort:r,signal:e.signal}}function Pr(n,e,t){if(typeof(t==null?void 0:t.addEventListener)=="function")return;let r=JSON.stringify(e);r.length>20&&(r=r.substring(0,16)+" ...");let s=JSON.stringify(t);throw s.length>20&&(s=s.substring(0,16)+" ..."),new Error(`Incorrect abort signal instance found! You passed two payloads to '${n}' but you should merge the second one containing '${s}' into the first one containing '${r}'! If you are using context shortcuts, you may want to use a method on 'ctx.api' instead.

If you want to prevent such mistakes in the future, consider using TypeScript. https://www.typescriptlang.org/`)}class De{constructor(e,t,r){p(this,"token");p(this,"options");p(this,"raw");p(this,"config");this.token=e,this.options=t;const{raw:s,use:i,installedTransformers:o}=Sr(e,t,r);this.raw=s,this.config={use:i,installedTransformers:()=>o.slice()}}getUpdates(e,t){return this.raw.getUpdates({...e},t)}setWebhook(e,t,r){return this.raw.setWebhook({url:e,...t},r)}deleteWebhook(e,t){return this.raw.deleteWebhook({...e},t)}getWebhookInfo(e){return this.raw.getWebhookInfo(e)}getMe(e){return this.raw.getMe(e)}logOut(e){return this.raw.logOut(e)}close(e){return this.raw.close(e)}sendMessage(e,t,r,s){return this.raw.sendMessage({chat_id:e,text:t,...r},s)}forwardMessage(e,t,r,s,i){return this.raw.forwardMessage({chat_id:e,from_chat_id:t,message_id:r,...s},i)}forwardMessages(e,t,r,s,i){return this.raw.forwardMessages({chat_id:e,from_chat_id:t,message_ids:r,...s},i)}copyMessage(e,t,r,s,i){return this.raw.copyMessage({chat_id:e,from_chat_id:t,message_id:r,...s},i)}copyMessages(e,t,r,s,i){return this.raw.copyMessages({chat_id:e,from_chat_id:t,message_ids:r,...s},i)}sendPhoto(e,t,r,s){return this.raw.sendPhoto({chat_id:e,photo:t,...r},s)}sendAudio(e,t,r,s){return this.raw.sendAudio({chat_id:e,audio:t,...r},s)}sendDocument(e,t,r,s){return this.raw.sendDocument({chat_id:e,document:t,...r},s)}sendVideo(e,t,r,s){return this.raw.sendVideo({chat_id:e,video:t,...r},s)}sendAnimation(e,t,r,s){return this.raw.sendAnimation({chat_id:e,animation:t,...r},s)}sendVoice(e,t,r,s){return this.raw.sendVoice({chat_id:e,voice:t,...r},s)}sendVideoNote(e,t,r,s){return this.raw.sendVideoNote({chat_id:e,video_note:t,...r},s)}sendMediaGroup(e,t,r,s){return this.raw.sendMediaGroup({chat_id:e,media:t,...r},s)}sendLocation(e,t,r,s,i){return this.raw.sendLocation({chat_id:e,latitude:t,longitude:r,...s},i)}editMessageLiveLocation(e,t,r,s,i,o){return this.raw.editMessageLiveLocation({chat_id:e,message_id:t,latitude:r,longitude:s,...i},o)}editMessageLiveLocationInline(e,t,r,s,i){return this.raw.editMessageLiveLocation({inline_message_id:e,latitude:t,longitude:r,...s},i)}stopMessageLiveLocation(e,t,r,s){return this.raw.stopMessageLiveLocation({chat_id:e,message_id:t,...r},s)}stopMessageLiveLocationInline(e,t,r){return this.raw.stopMessageLiveLocation({inline_message_id:e,...t},r)}sendPaidMedia(e,t,r,s,i){return this.raw.sendPaidMedia({chat_id:e,star_count:t,media:r,...s},i)}sendVenue(e,t,r,s,i,o,u){return this.raw.sendVenue({chat_id:e,latitude:t,longitude:r,title:s,address:i,...o},u)}sendContact(e,t,r,s,i){return this.raw.sendContact({chat_id:e,phone_number:t,first_name:r,...s},i)}sendPoll(e,t,r,s,i){return this.raw.sendPoll({chat_id:e,question:t,options:r,...s},i)}sendDice(e,t,r,s){return this.raw.sendDice({chat_id:e,emoji:t,...r},s)}setMessageReaction(e,t,r,s,i){return this.raw.setMessageReaction({chat_id:e,message_id:t,reaction:r,...s},i)}sendChatAction(e,t,r,s){return this.raw.sendChatAction({chat_id:e,action:t,...r},s)}getUserProfilePhotos(e,t,r){return this.raw.getUserProfilePhotos({user_id:e,...t},r)}setUserEmojiStatus(e,t,r){return this.raw.setUserEmojiStatus({user_id:e,...t},r)}getUserChatBoosts(e,t,r){return this.raw.getUserChatBoosts({chat_id:e,user_id:t},r)}getBusinessConnection(e,t){return this.raw.getBusinessConnection({business_connection_id:e},t)}getFile(e,t){return this.raw.getFile({file_id:e},t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r,s){return this.raw.banChatMember({chat_id:e,user_id:t,...r},s)}unbanChatMember(e,t,r,s){return this.raw.unbanChatMember({chat_id:e,user_id:t,...r},s)}restrictChatMember(e,t,r,s,i){return this.raw.restrictChatMember({chat_id:e,user_id:t,permissions:r,...s},i)}promoteChatMember(e,t,r,s){return this.raw.promoteChatMember({chat_id:e,user_id:t,...r},s)}setChatAdministratorCustomTitle(e,t,r,s){return this.raw.setChatAdministratorCustomTitle({chat_id:e,user_id:t,custom_title:r},s)}banChatSenderChat(e,t,r){return this.raw.banChatSenderChat({chat_id:e,sender_chat_id:t},r)}unbanChatSenderChat(e,t,r){return this.raw.unbanChatSenderChat({chat_id:e,sender_chat_id:t},r)}setChatPermissions(e,t,r,s){return this.raw.setChatPermissions({chat_id:e,permissions:t,...r},s)}exportChatInviteLink(e,t){return this.raw.exportChatInviteLink({chat_id:e},t)}createChatInviteLink(e,t,r){return this.raw.createChatInviteLink({chat_id:e,...t},r)}editChatInviteLink(e,t,r,s){return this.raw.editChatInviteLink({chat_id:e,invite_link:t,...r},s)}createChatSubscriptionInviteLink(e,t,r,s,i){return this.raw.createChatSubscriptionInviteLink({chat_id:e,subscription_period:t,subscription_price:r,...s},i)}editChatSubscriptionInviteLink(e,t,r,s){return this.raw.editChatSubscriptionInviteLink({chat_id:e,invite_link:t,...r},s)}revokeChatInviteLink(e,t,r){return this.raw.revokeChatInviteLink({chat_id:e,invite_link:t},r)}approveChatJoinRequest(e,t,r){return this.raw.approveChatJoinRequest({chat_id:e,user_id:t},r)}declineChatJoinRequest(e,t,r){return this.raw.declineChatJoinRequest({chat_id:e,user_id:t},r)}setChatPhoto(e,t,r){return this.raw.setChatPhoto({chat_id:e,photo:t},r)}deleteChatPhoto(e,t){return this.raw.deleteChatPhoto({chat_id:e},t)}setChatTitle(e,t,r){return this.raw.setChatTitle({chat_id:e,title:t},r)}setChatDescription(e,t,r){return this.raw.setChatDescription({chat_id:e,description:t},r)}pinChatMessage(e,t,r,s){return this.raw.pinChatMessage({chat_id:e,message_id:t,...r},s)}unpinChatMessage(e,t,r){return this.raw.unpinChatMessage({chat_id:e,message_id:t},r)}unpinAllChatMessages(e,t){return this.raw.unpinAllChatMessages({chat_id:e},t)}leaveChat(e,t){return this.raw.leaveChat({chat_id:e},t)}getChat(e,t){return this.raw.getChat({chat_id:e},t)}getChatAdministrators(e,t){return this.raw.getChatAdministrators({chat_id:e},t)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e,t){return this.raw.getChatMemberCount({chat_id:e},t)}getChatMember(e,t,r){return this.raw.getChatMember({chat_id:e,user_id:t},r)}setChatStickerSet(e,t,r){return this.raw.setChatStickerSet({chat_id:e,sticker_set_name:t},r)}deleteChatStickerSet(e,t){return this.raw.deleteChatStickerSet({chat_id:e},t)}getForumTopicIconStickers(e){return this.raw.getForumTopicIconStickers(e)}createForumTopic(e,t,r,s){return this.raw.createForumTopic({chat_id:e,name:t,...r},s)}editForumTopic(e,t,r,s){return this.raw.editForumTopic({chat_id:e,message_thread_id:t,...r},s)}closeForumTopic(e,t,r){return this.raw.closeForumTopic({chat_id:e,message_thread_id:t},r)}reopenForumTopic(e,t,r){return this.raw.reopenForumTopic({chat_id:e,message_thread_id:t},r)}deleteForumTopic(e,t,r){return this.raw.deleteForumTopic({chat_id:e,message_thread_id:t},r)}unpinAllForumTopicMessages(e,t,r){return this.raw.unpinAllForumTopicMessages({chat_id:e,message_thread_id:t},r)}editGeneralForumTopic(e,t,r){return this.raw.editGeneralForumTopic({chat_id:e,name:t},r)}closeGeneralForumTopic(e,t){return this.raw.closeGeneralForumTopic({chat_id:e},t)}reopenGeneralForumTopic(e,t){return this.raw.reopenGeneralForumTopic({chat_id:e},t)}hideGeneralForumTopic(e,t){return this.raw.hideGeneralForumTopic({chat_id:e},t)}unhideGeneralForumTopic(e,t){return this.raw.unhideGeneralForumTopic({chat_id:e},t)}unpinAllGeneralForumTopicMessages(e,t){return this.raw.unpinAllGeneralForumTopicMessages({chat_id:e},t)}answerCallbackQuery(e,t,r){return this.raw.answerCallbackQuery({callback_query_id:e,...t},r)}setMyName(e,t,r){return this.raw.setMyName({name:e,...t},r)}getMyName(e,t){return this.raw.getMyName(e??{},t)}setMyCommands(e,t,r){return this.raw.setMyCommands({commands:e,...t},r)}deleteMyCommands(e,t){return this.raw.deleteMyCommands({...e},t)}getMyCommands(e,t){return this.raw.getMyCommands({...e},t)}setMyDescription(e,t,r){return this.raw.setMyDescription({description:e,...t},r)}getMyDescription(e,t){return this.raw.getMyDescription({...e},t)}setMyShortDescription(e,t,r){return this.raw.setMyShortDescription({short_description:e,...t},r)}getMyShortDescription(e,t){return this.raw.getMyShortDescription({...e},t)}setChatMenuButton(e,t){return this.raw.setChatMenuButton({...e},t)}getChatMenuButton(e,t){return this.raw.getChatMenuButton({...e},t)}setMyDefaultAdministratorRights(e,t){return this.raw.setMyDefaultAdministratorRights({...e},t)}getMyDefaultAdministratorRights(e,t){return this.raw.getMyDefaultAdministratorRights({...e},t)}editMessageText(e,t,r,s,i){return this.raw.editMessageText({chat_id:e,message_id:t,text:r,...s},i)}editMessageTextInline(e,t,r,s){return this.raw.editMessageText({inline_message_id:e,text:t,...r},s)}editMessageCaption(e,t,r,s){return this.raw.editMessageCaption({chat_id:e,message_id:t,...r},s)}editMessageCaptionInline(e,t,r){return this.raw.editMessageCaption({inline_message_id:e,...t},r)}editMessageMedia(e,t,r,s,i){return this.raw.editMessageMedia({chat_id:e,message_id:t,media:r,...s},i)}editMessageMediaInline(e,t,r,s){return this.raw.editMessageMedia({inline_message_id:e,media:t,...r},s)}editMessageReplyMarkup(e,t,r,s){return this.raw.editMessageReplyMarkup({chat_id:e,message_id:t,...r},s)}editMessageReplyMarkupInline(e,t,r){return this.raw.editMessageReplyMarkup({inline_message_id:e,...t},r)}stopPoll(e,t,r,s){return this.raw.stopPoll({chat_id:e,message_id:t,...r},s)}deleteMessage(e,t,r){return this.raw.deleteMessage({chat_id:e,message_id:t},r)}deleteMessages(e,t,r){return this.raw.deleteMessages({chat_id:e,message_ids:t},r)}sendSticker(e,t,r,s){return this.raw.sendSticker({chat_id:e,sticker:t,...r},s)}getStickerSet(e,t){return this.raw.getStickerSet({name:e},t)}getCustomEmojiStickers(e,t){return this.raw.getCustomEmojiStickers({custom_emoji_ids:e},t)}uploadStickerFile(e,t,r,s){return this.raw.uploadStickerFile({user_id:e,sticker_format:t,sticker:r},s)}createNewStickerSet(e,t,r,s,i,o){return this.raw.createNewStickerSet({user_id:e,name:t,title:r,stickers:s,...i},o)}addStickerToSet(e,t,r,s){return this.raw.addStickerToSet({user_id:e,name:t,sticker:r},s)}setStickerPositionInSet(e,t,r){return this.raw.setStickerPositionInSet({sticker:e,position:t},r)}deleteStickerFromSet(e,t){return this.raw.deleteStickerFromSet({sticker:e},t)}replaceStickerInSet(e,t,r,s,i){return this.raw.replaceStickerInSet({user_id:e,name:t,old_sticker:r,sticker:s},i)}setStickerEmojiList(e,t,r){return this.raw.setStickerEmojiList({sticker:e,emoji_list:t},r)}setStickerKeywords(e,t,r){return this.raw.setStickerKeywords({sticker:e,keywords:t},r)}setStickerMaskPosition(e,t,r){return this.raw.setStickerMaskPosition({sticker:e,mask_position:t},r)}setStickerSetTitle(e,t,r){return this.raw.setStickerSetTitle({name:e,title:t},r)}deleteStickerSet(e,t){return this.raw.deleteStickerSet({name:e},t)}setStickerSetThumbnail(e,t,r,s,i){return this.raw.setStickerSetThumbnail({name:e,user_id:t,thumbnail:r,format:s},i)}setCustomEmojiStickerSetThumbnail(e,t,r){return this.raw.setCustomEmojiStickerSetThumbnail({name:e,custom_emoji_id:t},r)}getAvailableGifts(e){return this.raw.getAvailableGifts(e)}sendGift(e,t,r,s){return this.raw.sendGift({user_id:e,gift_id:t,...r},s)}answerInlineQuery(e,t,r,s){return this.raw.answerInlineQuery({inline_query_id:e,results:t,...r},s)}answerWebAppQuery(e,t,r){return this.raw.answerWebAppQuery({web_app_query_id:e,result:t},r)}savePreparedInlineMessage(e,t,r,s){return this.raw.savePreparedInlineMessage({user_id:e,result:t,...r},s)}sendInvoice(e,t,r,s,i,o,u,c){return this.raw.sendInvoice({chat_id:e,title:t,description:r,payload:s,currency:i,prices:o,...u},c)}createInvoiceLink(e,t,r,s,i,o,u,c){return this.raw.createInvoiceLink({title:e,description:t,payload:r,provider_token:s,currency:i,prices:o,...u},c)}answerShippingQuery(e,t,r,s){return this.raw.answerShippingQuery({shipping_query_id:e,ok:t,...r},s)}answerPreCheckoutQuery(e,t,r,s){return this.raw.answerPreCheckoutQuery({pre_checkout_query_id:e,ok:t,...r},s)}getStarTransactions(e,t){return this.raw.getStarTransactions({...e},t)}refundStarPayment(e,t,r){return this.raw.refundStarPayment({user_id:e,telegram_payment_charge_id:t},r)}editUserStarSubscription(e,t,r,s){return this.raw.editUserStarSubscription({user_id:e,telegram_payment_charge_id:t,is_canceled:r},s)}verifyUser(e,t,r){return this.raw.verifyUser({user_id:e,...t},r)}verifyChat(e,t,r){return this.raw.verifyChat({chat_id:e,...t},r)}removeUserVerification(e,t){return this.raw.removeUserVerification({user_id:e},t)}removeChatVerification(e,t){return this.raw.removeChatVerification({chat_id:e},t)}setPassportDataErrors(e,t,r){return this.raw.setPassportDataErrors({user_id:e,errors:t},r)}sendGame(e,t,r,s){return this.raw.sendGame({chat_id:e,game_short_name:t,...r},s)}setGameScore(e,t,r,s,i,o){return this.raw.setGameScore({chat_id:e,message_id:t,user_id:r,score:s,...i},o)}setGameScoreInline(e,t,r,s,i){return this.raw.setGameScore({inline_message_id:e,user_id:t,score:r,...s},i)}getGameHighScores(e,t,r,s){return this.raw.getGameHighScores({chat_id:e,message_id:t,user_id:r},s)}getGameHighScoresInline(e,t,r){return this.raw.getGameHighScores({inline_message_id:e,user_id:t},r)}}const I=b("grammy:bot"),Lr=b("grammy:warn"),Q=b("grammy:error"),et=["message","edited_message","channel_post","edited_channel_post","business_connection","business_message","edited_business_message","deleted_business_messages","inline_query","chosen_inline_result","callback_query","shipping_query","pre_checkout_query","poll","poll_answer","my_chat_member","chat_join_request","chat_boost","removed_chat_boost"];class jr extends P{constructor(t,r){super();p(this,"token");p(this,"pollingRunning");p(this,"pollingAbortController");p(this,"lastTriedUpdateId");p(this,"api");p(this,"me");p(this,"mePromise");p(this,"clientConfig");p(this,"ContextConstructor");p(this,"observedUpdateTypes");p(this,"errorHandler");if(this.token=t,this.pollingRunning=!1,this.lastTriedUpdateId=0,this.observedUpdateTypes=new Set,this.errorHandler=async s=>{var i,o;throw console.error("Error in middleware while handling update",(o=(i=s.ctx)==null?void 0:i.update)==null?void 0:o.update_id,s.error),console.error("No error handler was set!"),console.error("Set your own error handler with `bot.catch = ...`"),this.pollingRunning&&(console.error("Stopping bot"),await this.stop()),s},!t)throw new Error("Empty token!");this.me=r==null?void 0:r.botInfo,this.clientConfig=r==null?void 0:r.client,this.ContextConstructor=(r==null?void 0:r.ContextConstructor)??M,this.api=new De(t,this.clientConfig)}set botInfo(t){this.me=t}get botInfo(){if(this.me===void 0)throw new Error("Bot information unavailable! Make sure to call `await bot.init()` before accessing `bot.botInfo`!");return this.me}on(t,...r){for(const[s]of Ue(t).flatMap(Oe))this.observedUpdateTypes.add(s);return super.on(t,...r)}reaction(t,...r){return this.observedUpdateTypes.add("message_reaction"),super.reaction(t,...r)}isInited(){return this.me!==void 0}async init(t){if(!this.isInited()){I("Initializing bot"),this.mePromise??(this.mePromise=$e(()=>this.api.getMe(t),t));let r;try{r=await this.mePromise}finally{this.mePromise=void 0}this.me===void 0?this.me=r:I("Bot info was set by now, will not overwrite")}I(`I am ${this.me.username}!`)}async handleUpdates(t){for(const r of t){this.lastTriedUpdateId=r.update_id;try{await this.handleUpdate(r)}catch(s){if(s instanceof ue)await this.errorHandler(s);else throw console.error("FATAL: grammY unable to handle:",s),s}}}async handleUpdate(t,r){if(this.me===void 0)throw new Error("Bot not initialized! Either call `await bot.init()`, or directly set the `botInfo` option in the `Bot` constructor to specify a known bot info object.");I(`Processing update ${t.update_id}`);const s=new De(this.token,this.clientConfig,r),i=this.api.config.installedTransformers();i.length>0&&s.config.use(...i);const o=new this.ContextConstructor(t,s,this.me);try{await Ge(this.middleware(),o)}catch(u){throw Q(`Error in middleware for update ${t.update_id}`),new ue(u,o)}}async start(t){var s,i,o;const r=[];if(this.isInited()||r.push(this.init((s=this.pollingAbortController)==null?void 0:s.signal)),this.pollingRunning){await Promise.all(r),I("Simple long polling already running!");return}this.pollingRunning=!0,this.pollingAbortController=new AbortController;try{r.push($e(async()=>{var u;await this.api.deleteWebhook({drop_pending_updates:t==null?void 0:t.drop_pending_updates},(u=this.pollingAbortController)==null?void 0:u.signal)},(i=this.pollingAbortController)==null?void 0:i.signal)),await Promise.all(r),await((o=t==null?void 0:t.onStart)==null?void 0:o.call(t,this.botInfo))}catch(u){throw this.pollingRunning=!1,this.pollingAbortController=void 0,u}this.pollingRunning&&(Dr(this.observedUpdateTypes,t==null?void 0:t.allowed_updates),this.use=$r,I("Starting simple long polling"),await this.loop(t),I("Middleware is done running"))}async stop(){var t;if(this.pollingRunning){I("Stopping bot, saving update offset"),this.pollingRunning=!1,(t=this.pollingAbortController)==null||t.abort();const r=this.lastTriedUpdateId+1;await this.api.getUpdates({offset:r,limit:1}).finally(()=>this.pollingAbortController=void 0)}else I("Bot is not running!")}isRunning(){return this.pollingRunning}catch(t){this.errorHandler=t}async loop(t){const r=t==null?void 0:t.limit,s=(t==null?void 0:t.timeout)??30;let i=(t==null?void 0:t.allowed_updates)??[];try{for(;this.pollingRunning;){const o=await this.fetchUpdates({limit:r,timeout:s,allowed_updates:i});if(o===void 0)break;await this.handleUpdates(o),i=void 0}}finally{this.pollingRunning=!1}}async fetchUpdates({limit:t,timeout:r,allowed_updates:s}){var u;const i=this.lastTriedUpdateId+1;let o;do try{o=await this.api.getUpdates({offset:i,limit:t,timeout:r,allowed_updates:s},(u=this.pollingAbortController)==null?void 0:u.signal)}catch(c){await this.handlePollingError(c)}while(o===void 0&&this.pollingRunning);return o}async handlePollingError(t){if(!this.pollingRunning){I("Pending getUpdates request cancelled");return}let r=3;if(t instanceof fe){if(Q(t.message),t.error_code===401||t.error_code===409)throw t;t.error_code===429&&(Q("Bot API server is closing."),r=t.parameters.retry_after??r)}else Q(t);Q(`Call to getUpdates failed, retrying in ${r} seconds ...`),await pe(r)}}async function $e(n,e){let r=50;async function s(o){let u=!1,c="rethrow";if(o instanceof Ke)u=!0,c="retry";else if(o instanceof fe){if(o.error_code>=500)u=!0,c="retry";else if(o.error_code===429){const l=o.parameters.retry_after;typeof l=="number"?(await pe(l,e),r=50):u=!0,c="retry"}}if(u){r!==50&&await pe(r,e);const l=20*60*1e3;r=Math.min(l,2*r)}return c}let i={ok:!1};for(;!i.ok;)try{i={ok:!0,value:await n()}}catch(o){switch(Q(o),await s(o)){case"retry":continue;case"rethrow":throw o}}return i.value}async function pe(n,e){let t,r;function s(){r==null||r(new Error("Aborted delay")),t!==void 0&&clearTimeout(t)}try{await new Promise((i,o)=>{if(r=o,e!=null&&e.aborted){s();return}e==null||e.addEventListener("abort",s),t=setTimeout(i,1e3*n)})}finally{e==null||e.removeEventListener("abort",s)}}function Dr(n,e=et){const t=Array.from(n).filter(r=>!e.includes(r));t.length>0&&Lr(`You registered listeners for the following update types, but you did not specify them in \`allowed_updates\` so they may not be received: ${t.map(r=>`'${r}'`).join(", ")}`)}function $r(){throw new Error(`It looks like you are registering more listeners on your bot from within other listeners! This means that every time your bot handles a message like this one, new listeners will be added. This list grows until your machine crashes, so grammY throws this error to tell you that you should probably do things a bit differently. If you're unsure how to resolve this problem, you can ask in the group chat: https://telegram.me/grammyjs

On the other hand, if you actually know what you're doing and you do need to install further middleware while your bot is running, consider installing a composer instance on your bot, and in turn augment the composer after the fact. This way, you can circumvent this protection against memory leaks.`)}[...et];b("grammy:session");b("grammy:error");class Nr{constructor(e){p(this,"bot");this.bot=new jr(e),this.setupHandlers()}setupHandlers(){this.bot.command("start",async e=>{await e.reply("!       .     .")}),this.bot.command("help",async e=>{await e.reply(`    :
-   
-   
-   

   !`)}),this.bot.on("message:text",this.handleTextMessage.bind(this)),this.bot.on("message:photo",this.handlePhotoMessage.bind(this)),this.bot.on("message:document",this.handleDocumentMessage.bind(this)),this.bot.catch(e=>{console.error("Error in bot:",e)})}async handleTextMessage(e){var r;const t=(r=e.message)==null?void 0:r.text;t&&(t.startsWith("/")||await e.reply("    ,    /help   ."))}async handlePhotoMessage(e){try{await e.reply("    .  .")}catch(t){console.error("Error processing photo:",t),await e.reply("    . ,   .")}}async handleDocumentMessage(e){await e.reply("       ,   .")}async start(){try{console.log("Starting bot..."),await this.bot.start({drop_pending_updates:!0,onStart:()=>{console.log("Bot is running...")}})}catch(e){throw console.error("Error starting bot:",e),e}}async stop(){console.log("Stopping bot..."),await this.bot.stop()}}var A={exports:{}};const Ur={},Or=Object.freeze(Object.defineProperty({__proto__:null,default:Ur},Symbol.toStringTag,{value:"Module"})),re=ct(Or),Qr="dotenv",Gr="16.4.7",xr="Loads environment variables from .env file",Vr="lib/main.js",Br="lib/main.d.ts",qr={".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},Wr={"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard",pretest:"npm run lint && npm run dts-check",test:"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=lcov",prerelease:"npm test",release:"standard-version"},Kr={type:"git",url:"git://github.com/motdotla/dotenv.git"},Yr="https://dotenvx.com",Jr=["dotenv","env",".env","environment","variables","config","settings"],Hr="README.md",zr="BSD-2-Clause",Zr={"@types/node":"^18.11.3",decache:"^4.6.2",sinon:"^14.0.1",standard:"^17.0.0","standard-version":"^9.5.0",tap:"^19.2.0",typescript:"^4.8.4"},Xr={node:">=12"},en={fs:!1},tn={name:Qr,version:Gr,description:xr,main:Vr,types:Br,exports:qr,scripts:Wr,repository:Kr,funding:Yr,keywords:Jr,readmeFilename:Hr,license:zr,devDependencies:Zr,engines:Xr,browser:en},me=re,ge=re,rn=re,nn=re,sn=tn,ye=sn.version,on=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function an(n){const e={};let t=n.toString();t=t.replace(/\r\n?/mg,`
`);let r;for(;(r=on.exec(t))!=null;){const s=r[1];let i=r[2]||"";i=i.trim();const o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),o==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),e[s]=i}return e}function cn(n){const e=rt(n),t=C.configDotenv({path:e});if(!t.parsed){const o=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw o.code="MISSING_DATA",o}const r=tt(n).split(","),s=r.length;let i;for(let o=0;o<s;o++)try{const u=r[o].trim(),c=ln(t,u);i=C.decrypt(c.ciphertext,c.key);break}catch(u){if(o+1>=s)throw u}return C.parse(i)}function un(n){console.log(`[dotenv@${ye}][INFO] ${n}`)}function hn(n){console.log(`[dotenv@${ye}][WARN] ${n}`)}function te(n){console.log(`[dotenv@${ye}][DEBUG] ${n}`)}function tt(n){return n&&n.DOTENV_KEY&&n.DOTENV_KEY.length>0?n.DOTENV_KEY:{}.DOTENV_KEY&&{}.DOTENV_KEY.length>0?{}.DOTENV_KEY:""}function ln(n,e){let t;try{t=new URL(e)}catch(u){if(u.code==="ERR_INVALID_URL"){const c=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw c.code="INVALID_DOTENV_KEY",c}throw u}const r=t.password;if(!r){const u=new Error("INVALID_DOTENV_KEY: Missing key part");throw u.code="INVALID_DOTENV_KEY",u}const s=t.searchParams.get("environment");if(!s){const u=new Error("INVALID_DOTENV_KEY: Missing environment part");throw u.code="INVALID_DOTENV_KEY",u}const i=`DOTENV_VAULT_${s.toUpperCase()}`,o=n.parsed[i];if(!o){const u=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);throw u.code="NOT_FOUND_DOTENV_ENVIRONMENT",u}return{ciphertext:o,key:r}}function rt(n){let e=null;if(n&&n.path&&n.path.length>0)if(Array.isArray(n.path))for(const t of n.path)me.existsSync(t)&&(e=t.endsWith(".vault")?t:`${t}.vault`);else e=n.path.endsWith(".vault")?n.path:`${n.path}.vault`;else e=ge.resolve(process.cwd(),".env.vault");return me.existsSync(e)?e:null}function Ne(n){return n[0]==="~"?ge.join(rn.homedir(),n.slice(1)):n}function dn(n){un("Loading env from encrypted .env.vault");const e=C._parseVault(n);let t=process.env;return n&&n.processEnv!=null&&(t=n.processEnv),C.populate(t,e,n),{parsed:e}}function pn(n){const e=ge.resolve(process.cwd(),".env");let t="utf8";const r=!!(n&&n.debug);n&&n.encoding?t=n.encoding:r&&te("No encoding is specified. UTF-8 is used by default");let s=[e];if(n&&n.path)if(!Array.isArray(n.path))s=[Ne(n.path)];else{s=[];for(const c of n.path)s.push(Ne(c))}let i;const o={};for(const c of s)try{const l=C.parse(me.readFileSync(c,{encoding:t}));C.populate(o,l,n)}catch(l){r&&te(`Failed to load ${c} ${l.message}`),i=l}let u=process.env;return n&&n.processEnv!=null&&(u=n.processEnv),C.populate(u,o,n),i?{parsed:o,error:i}:{parsed:o}}function mn(n){if(tt(n).length===0)return C.configDotenv(n);const e=rt(n);return e?C._configVault(n):(hn(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),C.configDotenv(n))}function fn(n,e){const t=Buffer.from(e.slice(-64),"hex");let r=Buffer.from(n,"base64");const s=r.subarray(0,12),i=r.subarray(-16);r=r.subarray(12,-16);try{const o=nn.createDecipheriv("aes-256-gcm",t,s);return o.setAuthTag(i),`${o.update(r)}${o.final()}`}catch(o){const u=o instanceof RangeError,c=o.message==="Invalid key length",l=o.message==="Unsupported state or unable to authenticate data";if(u||c){const h=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw h.code="INVALID_DOTENV_KEY",h}else if(l){const h=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw h.code="DECRYPTION_FAILED",h}else throw o}}function gn(n,e,t={}){const r=!!(t&&t.debug),s=!!(t&&t.override);if(typeof e!="object"){const i=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw i.code="OBJECT_REQUIRED",i}for(const i of Object.keys(e))Object.prototype.hasOwnProperty.call(n,i)?(s===!0&&(n[i]=e[i]),r&&te(s===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):n[i]=e[i]}const C={configDotenv:pn,_configVault:dn,_parseVault:cn,config:mn,decrypt:fn,parse:an,populate:gn};A.exports.configDotenv=C.configDotenv;A.exports._configVault=C._configVault;A.exports._parseVault=C._parseVault;var yn=A.exports.config=C.config;A.exports.decrypt=C.decrypt;A.exports.parse=C.parse;A.exports.populate=C.populate;A.exports=C;yn();const we={}.TELEGRAM_BOT_TOKEN;we||(console.error("TELEGRAM_BOT_TOKEN     "),process.exit(1));console.log("Using bot token:",we);const nt=new Nr(we);process.on("SIGINT",async()=>{console.log("  ..."),await nt.stop(),process.exit(0)});nt.start().catch(n=>{console.error("   :",n),process.exit(1)});
